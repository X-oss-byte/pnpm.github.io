"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4796],{9613:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>k});var a=t(9496);function p(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){p(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,a,p=function(e,n){if(null==e)return{};var t,a,p={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(p[t]=e[t]);return p}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(p[t]=e[t])}return p}var o=a.createContext({}),s=function(e){var n=a.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},d=function(e){var n=s(e.components);return a.createElement(o.Provider,{value:n},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,p=e.mdxType,i=e.originalType,o=e.parentName,d=r(e,["components","mdxType","originalType","parentName"]),c=s(t),u=p,k=c["".concat(o,".").concat(u)]||c[u]||m[u]||i;return t?a.createElement(k,l(l({ref:n},d),{},{components:t})):a.createElement(k,l({ref:n},d))}));function k(e,n){var t=arguments,p=n&&n.mdxType;if("string"==typeof e||p){var i=t.length,l=new Array(i);l[0]=u;var r={};for(var o in n)hasOwnProperty.call(n,o)&&(r[o]=n[o]);r.originalType=e,r[c]="string"==typeof e?e:p,l[1]=r;for(var s=2;s<i;s++)l[s]=t[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},6093:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>k,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var a=t(1966),p=t(9836),i=(t(9496),t(9613)),l=["components"],r={id:"package_json",title:"package.json"},o=void 0,s={unversionedId:"package_json",id:"package_json",title:"package.json",description:"\u4e00\u4e2a\u5305\u7684\u6e05\u5355\u6587\u4ef6\u3002 \u5b83\u5305\u542b\u5305\u7684\u6240\u6709\u5143\u6570\u636e\uff0c\u5305\u62ec\u4f9d\u8d56\u9879\u3001\u6807\u9898\u3001\u4f5c\u8005\u7b49\u7b49\u3002 \u8fd9\u662f\u6240\u6709\u4e3b\u8981\u7684 Node.JS \u5305\u7ba1\u7406\u5de5\u5177\uff0c\u5305\u62ec pnpm \u7684\u4fdd\u7559\u6807\u51c6\u3002",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/package_json.md",sourceDirName:".",slug:"/package_json",permalink:"/zh/next/package_json",draft:!1,editUrl:"https://translate.pnpm.io/project/pnpm/zh-CN",tags:[],version:"current",frontMatter:{id:"package_json",title:"package.json"},sidebar:"docs",previous:{title:"pnpm config",permalink:"/zh/next/cli/config"},next:{title:".npmrc",permalink:"/zh/next/npmrc"}},d={},c=[{value:"engines",id:"engines",level:2},{value:"dependenciesMeta",id:"dependenciesmeta",level:2},{value:"dependenciesMeta.*.injected",id:"dependenciesmetainjected",level:3},{value:"peerDependenciesMeta",id:"peerdependenciesmeta",level:2},{value:"peerDependenciesMeta.*.optional",id:"peerdependenciesmetaoptional",level:3},{value:"publishConfig",id:"publishconfig",level:2},{value:"publishConfig.executableFiles",id:"publishconfigexecutablefiles",level:3},{value:"publishConfig.directory",id:"publishconfigdirectory",level:3},{value:"publishConfig.linkDirectory",id:"publishconfiglinkdirectory",level:3},{value:"pnpm.overrides",id:"pnpmoverrides",level:2},{value:"pnpm.packageExtensions",id:"pnpmpackageextensions",level:2},{value:"pnpm.peerDependencyRules",id:"pnpmpeerdependencyrules",level:2},{value:"pnpm.peerDependencyRules.ignoreMissing",id:"pnpmpeerdependencyrulesignoremissing",level:3},{value:"pnpm.peerDependencyRules.allowedVersions",id:"pnpmpeerdependencyrulesallowedversions",level:3},{value:"pnpm.peerDependencyRules.allowAny",id:"pnpmpeerdependencyrulesallowany",level:3},{value:"pnpm.neverBuiltDependencies",id:"pnpmneverbuiltdependencies",level:2},{value:"pnpm.onlyBuiltDependencies",id:"pnpmonlybuiltdependencies",level:2},{value:"pnpm.allowedDeprecatedVersions",id:"pnpmalloweddeprecatedversions",level:2},{value:"pnpm.patchedDependencies",id:"pnpmpatcheddependencies",level:2},{value:"pnpm.allowNonAppliedPatches",id:"pnpmallownonappliedpatches",level:2},{value:"pnpm.updateConfig",id:"pnpmupdateconfig",level:2},{value:"pnpm.updateConfig.ignoreDependencies",id:"pnpmupdateconfigignoredependencies",level:3},{value:"pnpm.auditConfig",id:"pnpmauditconfig",level:2},{value:"pnpm.auditConfig.ignoreCves",id:"pnpmauditconfigignorecves",level:3},{value:"pnpm.requiredScripts",id:"pnpmrequiredscripts",level:2},{value:"resolutions",id:"resolutions",level:2}],m={toc:c},u="wrapper";function k(e){var n=e.components,t=(0,p.Z)(e,l);return(0,i.kt)(u,(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"\u4e00\u4e2a\u5305\u7684\u6e05\u5355\u6587\u4ef6\u3002 \u5b83\u5305\u542b\u5305\u7684\u6240\u6709\u5143\u6570\u636e\uff0c\u5305\u62ec\u4f9d\u8d56\u9879\u3001\u6807\u9898\u3001\u4f5c\u8005\u7b49\u7b49\u3002 \u8fd9\u662f\u6240\u6709\u4e3b\u8981\u7684 Node.JS \u5305\u7ba1\u7406\u5de5\u5177\uff0c\u5305\u62ec pnpm \u7684\u4fdd\u7559\u6807\u51c6\u3002"),(0,i.kt)("h2",{id:"engines"},"engines"),(0,i.kt)("p",null,"\u4f60\u53ef\u4ee5\u6307\u5b9a\u4f60\u7684\u8f6f\u4ef6\u80fd\u591f\u8fd0\u884c\u7684 Node \u7248\u672c\u548c pnpm \u7248\u672c\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "engines": {\n        "node": ">=10",\n        "pnpm": ">=3"\n    }\n}\n')),(0,i.kt)("p",null,"\u5728\u672c\u5730\u5f00\u53d1\u65f6\uff0c \u5982\u679c\u5176\u7248\u672c\u4e0e ",(0,i.kt)("inlineCode",{parentName:"p"},"engines")," \u5b57\u6bb5\u4e2d\u6307\u5b9a\u7684\u7248\u672c\u4e0d\u5339\u914d\uff0cpnpm \u5c06\u59cb\u7ec8\u5931\u8d25\u5e76\u62a5\u9519\u3002"),(0,i.kt)("p",null,"\u5f53\u4f60\u7684\u5305\u4f5c\u4e3a\u4f9d\u8d56\u88ab\u5b89\u88c5\u65f6\uff0c\u9664\u975e\u7528\u6237\u5df2\u8bbe\u7f6e ",(0,i.kt)("inlineCode",{parentName:"p"},"engine-strict")," \u914d\u7f6e\u6807\u5fd7 (\u53c2\u9605 ",(0,i.kt)("a",{parentName:"p",href:"/zh/next/npmrc#engine-strict"},".npmrc"),")\uff0c\u5426\u5219\u6b64\u5b57\u6bb5\u4ec5\u4f9b\u53c2\u8003\uff0c\u4e14\u53ea\u4f1a\u4ea7\u751f\u8b66\u544a\u3002"),(0,i.kt)("h2",{id:"dependenciesmeta"},"dependenciesMeta"),(0,i.kt)("p",null,"\u7528\u4e8e\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"dependencies"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"optionalDependencies")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"devDependencies")," \u4e2d\u58f0\u660e\u7684\u4f9d\u8d56\u9879\u7684\u8865\u5145\u5143\u4fe1\u606f\u3002"),(0,i.kt)("h3",{id:"dependenciesmetainjected"},"dependenciesMeta.*.injected"),(0,i.kt)("p",null,"\u5982\u679c\u5bf9\u672c\u5730\u4f9d\u8d56\u9879\u5c06\u6b64\u8bbe\u7f6e\u4e3a true\uff0c\u5219",(0,i.kt)("inlineCode",{parentName:"p"},"package"),"\u5c06\u88ab\u786c\u94fe\u63a5\u5230\u6a21\u5757\u76ee\u5f55\uff0c\u800c\u975e\u8f6f\u94fe\u63a5\u3002"),(0,i.kt)("p",null,"\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u5de5\u4f5c\u7a7a\u95f4\u4e2d\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json")," \u4f1a\u5728",(0,i.kt)("inlineCode",{parentName:"p"},"card"),"\u7684",(0,i.kt)("inlineCode",{parentName:"p"},"node_modules")," \u76ee\u5f55\u4e2d\u521b\u5efa\u4e00\u4e2a ",(0,i.kt)("inlineCode",{parentName:"p"},"button")," \u7684\u8f6f\u94fe\u63a5\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "card",\n  "dependencies": {\n    "button": "workspace:1.0.0"\n  }\n}\n')),(0,i.kt)("p",null,"\u4f46\u662f\u5982\u679c ",(0,i.kt)("inlineCode",{parentName:"p"},"button")," \u5728\u5176",(0,i.kt)("inlineCode",{parentName:"p"},"peer dependencies"),"\u4e2d\u542b\u6709 ",(0,i.kt)("inlineCode",{parentName:"p"},"react "),"\u5462\uff1f \u5982\u679c monorepo \u4e2d\u7684\u6240\u6709\u9879\u76ee\u90fd\u4f7f\u7528\u76f8\u540c\u7248\u672c\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"react"),"\uff0c\u90a3\u4e48\u4e0d\u4f1a\u6709\u4ec0\u4e48\u95ee\u9898\u3002 \u4f46\u8981\u662f ",(0,i.kt)("inlineCode",{parentName:"p"},"card "),"\u4f9d\u8d56\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"button")," \u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"react@16"),"\uff0c\u800c\u4f9d\u8d56\u7684",(0,i.kt)("inlineCode",{parentName:"p"}," form")," \u5374\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"react@17")," \u5462\uff1f \u5982\u679c\u4e0d\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"injection"),"\uff0c\u60a8\u5fc5\u987b\u9009\u62e9\u5355\u4e00\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"react")," \u7248\u672c\u5e76\u5c06\u5176\u4f5c\u4e3a",(0,i.kt)("inlineCode",{parentName:"p"},"button"),"\u7684 dev dependency \u5b89\u88c5\u3002 \u4f46\u662f\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"injected")," \u5b57\u6bb5\uff0c\u60a8\u53ef\u4ee5\u5c06 ",(0,i.kt)("inlineCode",{parentName:"p"},"button")," \u6ce8\u5165\u5230\u4e00\u4e2a",(0,i.kt)("inlineCode",{parentName:"p"},"package"),"\u4e2d\uff0c\u800c ",(0,i.kt)("inlineCode",{parentName:"p"},"button")," \u5c06\u4e0e\u8be5",(0,i.kt)("inlineCode",{parentName:"p"},"package")," \u4e2d\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"react"),"\u7248\u672c\u4e00\u540c\u5b89\u88c5\u3002"),(0,i.kt)("p",null,"\u56e0\u6b64\uff0c\u8fd9\u5c06\u662f ",(0,i.kt)("inlineCode",{parentName:"p"},"card "),"\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json"),"\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "card",\n  "dependencies": {\n    "button": "workspace:1.0.0",\n    "react": "16"\n  },\n  "dependenciesMeta": {\n    "button": {\n      "injected": true\n    }\n  }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"button"),"\u5c06\u88ab\u786c\u94fe\u63a5\u8fdb ",(0,i.kt)("inlineCode",{parentName:"p"},"card"),"\u7684\u4f9d\u8d56\u9879\u4e2d\uff0c\u540c\u65f6",(0,i.kt)("inlineCode",{parentName:"p"},"react@16")," \u4f1a\u88ab\u8f6f\u94fe\u63a5\u5230",(0,i.kt)("inlineCode",{parentName:"p"},"card/node_modules/button"),"\u7684\u4f9d\u8d56\u9879\u3002"),(0,i.kt)("p",null,"\u800c\u4e14\uff0c\u8fd9\u5c06\u662f ",(0,i.kt)("inlineCode",{parentName:"p"},"form "),"\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json"),"\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "form",\n  "dependencies": {\n    "button": "workspace:1.0.0",\n    "react": "17"\n  },\n  "dependenciesMeta": {\n    "button": {\n      "injected": true\n    }\n  }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"button"),"\u5c06\u88ab\u786c\u94fe\u63a5\u8fdb ",(0,i.kt)("inlineCode",{parentName:"p"},"form"),"\u7684\u4f9d\u8d56\u9879\u4e2d\uff0c\u540c\u65f6",(0,i.kt)("inlineCode",{parentName:"p"},"react@17")," \u4f1a\u88ab\u8f6f\u94fe\u63a5\u5230",(0,i.kt)("inlineCode",{parentName:"p"},"form/node_modules/button"),"\u7684\u4f9d\u8d56\u9879\u3002"),(0,i.kt)("p",null,"\u4e0e\u666e\u901a\u4f9d\u8d56\u9879\u4e0d\u540c\uff0c\u6ce8\u5165\u7684\u4f9d\u8d56\u9879\u4e0d\u4f1a\u94fe\u63a5\u5230\u76ee\u6807\u6587\u4ef6\u5939\uff0c\u56e0\u6b64\u5b83\u4eec\u4e0d\u4f1a\u81ea\u52a8\u66f4\u65b0\uff0c\u4f8b\u5982\u5728\u8fd0\u884c\u6784\u5efa\u811a\u672c\u540e\u3002 \u8981\u5c06\u786c\u94fe\u63a5\u7684\u6587\u4ef6\u5939\u5185\u5bb9\u66f4\u65b0\u4e3a\u4f9d\u8d56\u5305\u6587\u4ef6\u5939\u7684\u6700\u65b0\u72b6\u6001\uff0c\u8bf7\u518d\u6b21\u8c03\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"pnpm i"),"\u3002"),(0,i.kt)("p",null,"\u8bf7\u6ce8\u610f\uff0c ",(0,i.kt)("inlineCode",{parentName:"p"},"button")," \u5305\u5fc5\u987b\u5177\u6709\u5728\u5b89\u88c5\u65f6\u8fd0\u884c\u7684\u751f\u547d\u5468\u671f\u811a\u672c\uff0c\u4ee5\u4fbf ",(0,i.kt)("inlineCode",{parentName:"p"},"pnpm")," \u68c0\u6d4b\u66f4\u6539\u5e76\u66f4\u65b0\u5b83\u3002 \u4f8b\u5982\uff0c\u53ef\u4ee5\u5728\u5b89\u88c5\u65f6\u91cd\u65b0\u6784\u5efa\u5305: ",(0,i.kt)("inlineCode",{parentName:"p"},'"prepare": "pnpm run build"'),"\u3002 \u4efb\u4f55\u811a\u672c\u90fd\u5c06\u8d77\u4f5c\u7528\uff0c\u5373\u4f7f\u662f\u7b80\u5355\u7684\u65e0\u5173\u547d\u4ee4\u4e5f\u4e0d\u4f1a\u4ea7\u751f\u526f\u4f5c\u7528\uff0c\u4f8b\u5982: ",(0,i.kt)("inlineCode",{parentName:"p"},'"prepare": "pnpm root"'),"\u3002"),(0,i.kt)("h2",{id:"peerdependenciesmeta"},"peerDependenciesMeta"),(0,i.kt)("p",null,"This field lists some extra information related to the dependencies listed in the ",(0,i.kt)("inlineCode",{parentName:"p"},"peerDependencies")," field."),(0,i.kt)("h3",{id:"peerdependenciesmetaoptional"},"peerDependenciesMeta.*.optional"),(0,i.kt)("p",null,"If this is set to true, the selected peer dependency will be marked as optional by the package manager. Therefore, the consumer omitting it will no longer be reported as an error."),(0,i.kt)("p",null,"\u793a\u4f8b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "peerDependencies": {\n        "foo": "1"\n    },\n    "peerDependenciesMeta": {\n        "foo": {\n            "optional": true\n        },\n        "bar": {\n            "optional": true\n        }\n    }\n}\n')),(0,i.kt)("p",null,"Note that even though ",(0,i.kt)("inlineCode",{parentName:"p"},"bar")," was not specified in ",(0,i.kt)("inlineCode",{parentName:"p"},"peerDependencies"),", it is marked as optional. pnpm will therefore assume that any version of bar is fine. However, ",(0,i.kt)("inlineCode",{parentName:"p"},"foo")," is optional, but only to the required version specification."),(0,i.kt)("h2",{id:"publishconfig"},"publishConfig"),(0,i.kt)("p",null,"It is possible to override some fields in the manifest before the package is packed. The following fields may be overridden:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/stereobooster/package.json#bin"},(0,i.kt)("inlineCode",{parentName:"a"},"bin"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/stereobooster/package.json#main"},(0,i.kt)("inlineCode",{parentName:"a"},"main"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://nodejs.org/api/esm.html#esm_package_exports"},(0,i.kt)("inlineCode",{parentName:"a"},"exports"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/stereobooster/package.json#types"},(0,i.kt)("inlineCode",{parentName:"a"},"types")," or ",(0,i.kt)("inlineCode",{parentName:"a"},"typings"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/stereobooster/package.json#module"},(0,i.kt)("inlineCode",{parentName:"a"},"module"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/stereobooster/package.json#browser"},(0,i.kt)("inlineCode",{parentName:"a"},"browser"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/stereobooster/package.json#esnext"},(0,i.kt)("inlineCode",{parentName:"a"},"esnext"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/stereobooster/package.json#es2015"},(0,i.kt)("inlineCode",{parentName:"a"},"es2015"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/stereobooster/package.json#unpkg-1"},(0,i.kt)("inlineCode",{parentName:"a"},"unpkg"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/stereobooster/package.json#microbundle"},(0,i.kt)("inlineCode",{parentName:"a"},"umd:main"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.typescriptlang.org/docs/handbook/declaration-files/publishing.html#version-selection-with-typesversions"},(0,i.kt)("inlineCode",{parentName:"a"},"typesVersions"))),(0,i.kt)("li",{parentName:"ul"},"cpu"),(0,i.kt)("li",{parentName:"ul"},"os")),(0,i.kt)("p",null,"To override a field, add the publish version of the field to ",(0,i.kt)("inlineCode",{parentName:"p"},"publishConfig"),"."),(0,i.kt)("p",null,"For instance, the following ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "name": "foo",\n    "version": "1.0.0",\n    "main": "src/index.ts",\n    "publishConfig": {\n        "main": "lib/index.js",\n        "typings": "lib/index.d.ts"\n    }\n}\n')),(0,i.kt)("p",null,"Will be published as:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "name": "foo",\n    "version": "1.0.0",\n    "main": "lib/index.js",\n    "typings": "lib/index.d.ts"\n}\n')),(0,i.kt)("h3",{id:"publishconfigexecutablefiles"},"publishConfig.executableFiles"),(0,i.kt)("p",null,"By default, for portability reasons, no files except those listed in the bin field will be marked as executable in the resulting package archive. The ",(0,i.kt)("inlineCode",{parentName:"p"},"executableFiles")," field lets you declare additional fields that must have the executable flag (+x) set even if they aren't directly accessible through the bin field."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "publishConfig": {\n    "executableFiles": [\n      "./dist/shim.js"\n    ]\n  }\n}\n')),(0,i.kt)("h3",{id:"publishconfigdirectory"},"publishConfig.directory"),(0,i.kt)("p",null,"You also can use the field ",(0,i.kt)("inlineCode",{parentName:"p"},"publishConfig.directory")," to customize the published subdirectory relative to the current ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json"),"."),(0,i.kt)("p",null,"It is expected to have a modified version of the current package in the specified directory (usually using third party build tools)."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d ",(0,i.kt)("inlineCode",{parentName:"p"},'"dist"')," \u6587\u4ef6\u5939\u5fc5\u987b\u5305\u542b\u4e00\u4e2a ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json"))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "foo",\n  "version": "1.0.0",\n  "publishConfig": {\n    "directory": "dist"\n  }\n}\n')),(0,i.kt)("h3",{id:"publishconfiglinkdirectory"},"publishConfig.linkDirectory"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u9ed8\u8ba4\u503c\uff1a ",(0,i.kt)("strong",{parentName:"li"},"true")),(0,i.kt)("li",{parentName:"ul"},"\u7c7b\u578b\uff1a",(0,i.kt)("strong",{parentName:"li"},"Boolean"))),(0,i.kt)("p",null,"When set to ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),", the project will be symlinked from the ",(0,i.kt)("inlineCode",{parentName:"p"},"publishConfig.directory")," location during local development."),(0,i.kt)("p",null,"\u793a\u4f8b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "foo",\n  "version": "1.0.0",\n  "publishConfig": {\n    "directory": "dist"\n  }\n}\n')),(0,i.kt)("h2",{id:"pnpmoverrides"},"pnpm.overrides"),(0,i.kt)("p",null,"\u6b64\u5b57\u6bb5\u5141\u8bb8\u60a8\u6307\u793a pnpm \u8986\u76d6\u4f9d\u8d56\u5173\u7cfb\u56fe\u4e2d\u7684\u4efb\u4f55\u4f9d\u8d56\u9879\u3002 \u8fd9\u5bf9\u4e8e\u60a8\u5f3a\u5236\u6240\u6709\u7684",(0,i.kt)("inlineCode",{parentName:"p"},"packages"),"\u4f7f\u7528\u5355\u4e2a\u7248\u672c\u7684\u4f9d\u8d56\u9879\uff0c\u6216\u505a\u540e\u79fb\u690d\u7684\u4fee\u590d\uff0c\u6216\u7528\u4e00\u4e2a fork \u6765\u66ff\u6362\u4f9d\u8d56\u9879\u65f6\u5c06\u5341\u5206\u6709\u7528\u3002"),(0,i.kt)("p",null,"\u8bf7\u6ce8\u610f\uff0coverrides \u5b57\u6bb5\u53ea\u80fd\u5728\u9879\u76ee\u7684\u6839\u76ee\u5f55\u4e0b\u8bbe\u7f6e\u3002"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},'"pnpm"."overrides"')," \u5b57\u6bb5\u7684\u793a\u4f8b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "overrides": {\n      "foo": "^1.0.0",\n      "quux": "npm:@myorg/quux@^1.0.0",\n      "bar@^2.1.0": "3.0.0",\n      "qar@1>zoo": "2"\n    }\n  }\n}\n')),(0,i.kt)("p",null,'\u4f60\u53ef\u4ee5\u6307\u5b9a\u8986\u5199\u4f9d\u8d56\u7684 package \uff0c\u901a\u8fc7\u7528">"\u6765\u4ece\u4f9d\u8d56\u7684\u9009\u62e9\u5668\u5206\u79bb\u51fa package \u7684\u9009\u62e9\u5668\u3002\u4f8b\u5982\uff0cqar@1>zoo \u5c06\u53ea\u4f1a\u91cd\u5199 qar@1 \u7684 zoo \u4f9d\u8d56\u3002'),(0,i.kt)("p",null,"An override may be defined as a reference to a direct dependency's spec. This is achieved by prefixing the name of the dependency with a ",(0,i.kt)("inlineCode",{parentName:"p"},"$"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "dependencies": {\n    "foo": "^1.0.0"\n  },\n  "pnpm": {\n    "overrides": {\n      "foo": "$foo"\n    }\n  }\n}\n')),(0,i.kt)("p",null,"The referenced package does not need to match the overridden one:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "dependencies": {\n    "foo": "^1.0.0"\n  },\n  "pnpm": {\n    "overrides": {\n      "bar": "$foo"\n    }\n  }  \n}\n')),(0,i.kt)("h2",{id:"pnpmpackageextensions"},"pnpm.packageExtensions"),(0,i.kt)("p",null,"\u8fd9\u4e2a ",(0,i.kt)("inlineCode",{parentName:"p"},"packageExtension")," \u5b57\u6bb5\u63d0\u4f9b\u4e86\u4e00\u79cd\u7528\u989d\u5916\u4fe1\u606f\u6269\u5c55\u73b0\u6709",(0,i.kt)("inlineCode",{parentName:"p"},"package"),"\u5b9a\u4e49\u7684\u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5982\u679c",(0,i.kt)("inlineCode",{parentName:"p"},"react-redux")," \u672c\u5e94\u8be5\u5728\u5b83\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"peerDependencies")," \u4e2d\u5305\u542b ",(0,i.kt)("inlineCode",{parentName:"p"},"react-dom "),"\uff0c\u4f46\u5374\u6ca1\u6709\uff0c\u5219\u53ef\u4ee5\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"packageExtensions "),"\u6765\u586b\u8865\u4e0a",(0,i.kt)("inlineCode",{parentName:"p"},"react-redux"),"\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "packageExtensions": {\n      "react-redux": {\n        "peerDependencies": {\n          "react-dom": "*"\n        }\n      }\n    }\n  }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"packageExtensions")," \u4e2d\u7684\u952e\u662f",(0,i.kt)("inlineCode",{parentName:"p"},"package"),"\u540d\u79f0\u6216 semver \u7684",(0,i.kt)("inlineCode",{parentName:"p"},"package"),"\u540d\u79f0\uff0c\u56e0\u6b64\u53ef\u4ee5\u53ea\u4fee\u6539",(0,i.kt)("inlineCode",{parentName:"p"},"package"),"\u7684\u67d0\u4e9b\u7248\u672c\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "packageExtensions": {\n      "react-redux@1": {\n        "peerDependencies": {\n          "react-dom": "*"\n        }\n      }\n    }\n  }\n}\n')),(0,i.kt)("p",null,"\u4ee5\u4e0b\u5b57\u6bb5\u53ef\u4ee5\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"packageExtensions "),"\u88ab\u6269\u5c55\uff1a",(0,i.kt)("inlineCode",{parentName:"p"},"dependencies")," ",(0,i.kt)("inlineCode",{parentName:"p"},"optionalDependencies")," ",(0,i.kt)("inlineCode",{parentName:"p"},"peerDependencies")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"peerDependenciesMeta"),"\u3002"),(0,i.kt)("p",null,"\u4e00\u4e2a\u66f4\u5927\u7684\u4f8b\u5b50\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "packageExtensions": {\n      "express@1": {\n        "optionalDependencies": {\n          "typescript": "2"\n        }\n      },\n      "fork-ts-checker-webpack-plugin": {\n        "dependencies": {\n          "@babel/core": "1"\n        },\n        "peerDependencies": {\n          "eslint": ">= 6"\n        },\n        "peerDependenciesMeta": {\n          "eslint": {\n            "optional": true\n          }\n        }\n      }\n    }\n  }\n}\n')),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Together with Yarn, we maintain a database of ",(0,i.kt)("inlineCode",{parentName:"p"},"packageExtensions")," to patch broken packages in the ecosystem. If you use ",(0,i.kt)("inlineCode",{parentName:"p"},"packageExtensions"),", consider sending a PR upstream and contributing your extension to the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/yarnpkg/berry/blob/master/packages/yarnpkg-extensions/sources/index.ts"},(0,i.kt)("inlineCode",{parentName:"a"},"@yarnpkg/extensions"))," database.")),(0,i.kt)("h2",{id:"pnpmpeerdependencyrules"},"pnpm.peerDependencyRules"),(0,i.kt)("h3",{id:"pnpmpeerdependencyrulesignoremissing"},"pnpm.peerDependencyRules.ignoreMissing"),(0,i.kt)("p",null,"pnpm \u4e0d\u4f1a\u6253\u5370\u6709\u5173\u4f9d\u8d56\u5217\u8868\u4e2d\u7f3a\u5c11\u5bf9 peerDependency \u7684\u8b66\u544a\u3002"),(0,i.kt)("p",null,"\u4f8b\u5982\uff0c\u4f7f\u7528\u4ee5\u4e0b\u914d\u7f6e\uff0c\u5982\u679c\u4f9d\u8d56\u9879\u9700\u8981 ",(0,i.kt)("inlineCode",{parentName:"p"},"react")," \u4f46\u672a\u5b89\u88c5 ",(0,i.kt)("inlineCode",{parentName:"p"},"react"),"\uff0cpnpm \u4e0d\u4f1a\u6253\u5370\u76f8\u5e94\u8b66\u544a\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "peerDependencyRules": {\n      "ignoreMissing": ["react"]\n    }\n  }\n}\n')),(0,i.kt)("p",null,"Package name patterns may also be used:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "peerDependencyRules": {\n      "ignoreMissing": ["@babel/*", "@eslint/*"]\n    }\n  }\n}\n')),(0,i.kt)("h3",{id:"pnpmpeerdependencyrulesallowedversions"},"pnpm.peerDependencyRules.allowedVersions"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u6307\u5b9a\u7248\u672c\u8303\u56f4\u7684 peerDependency\uff0c\u5c06\u4e0d\u4f1a\u6253\u5370\u672a\u6ee1\u8db3\u7248\u672c\u8303\u56f4\u7684\u8b66\u544a\u3002"),(0,i.kt)("p",null,"\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u6709\u4e00\u4e9b\u4f9d\u8d56\u9879\u9700\u8981 ",(0,i.kt)("inlineCode",{parentName:"p"},"react@16")," \u4f46\u60a8\u77e5\u9053\u5b83\u4eec\u53ef\u4ee5\u4e0e ",(0,i.kt)("inlineCode",{parentName:"p"},"react@17")," \u4e00\u540c\u6b63\u5e38\u5de5\u4f5c\uff0c\u90a3\u4e48\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u914d\u7f6e\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "peerDependencyRules": {\n      "allowedVersions": {\n        "react": "17"\n      }\n    }\n  }\n}\n')),(0,i.kt)("p",null,"\u8fd9\u5c06\u544a\u8bc9 pnpm \u4efb\u4f55\u5728\u5176 peerDependency \u4e2d\u542b\u6709 react \u7684\u4f9d\u8d56\u9879\u90fd\u5e94\u8be5\u5141\u8bb8\u5b89\u88c5 ",(0,i.kt)("inlineCode",{parentName:"p"},"react")," v17\u3002"),(0,i.kt)("p",null,"It is also possible to suppress the warnings only for peer dependencies of specific packages. For instance, with the following configuration ",(0,i.kt)("inlineCode",{parentName:"p"},"react")," v17 will be only allowed when it is in the peer dependencies of the ",(0,i.kt)("inlineCode",{parentName:"p"},"button")," v2 package or in the dependencies of any ",(0,i.kt)("inlineCode",{parentName:"p"},"card")," package:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "peerDependencyRules": {\n      "allowedVersions": {\n        "button@2>react": "17",\n        "card>react": "17"\n      }\n    }\n  }\n}\n')),(0,i.kt)("h3",{id:"pnpmpeerdependencyrulesallowany"},"pnpm.peerDependencyRules.allowAny"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"allowAny")," is an array of package name patterns, any peer dependency matching the pattern will be resolved from any version, regardless of the range specified in ",(0,i.kt)("inlineCode",{parentName:"p"},"peerDependencies"),". \u4f8b\u5982\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "peerDependencyRules": {\n      "allowAny": ["@babel/*", "eslint"]\n    }\n  }\n}\n')),(0,i.kt)("p",null,"The above setting will mute any warnings about peer dependency version mismatches related to ",(0,i.kt)("inlineCode",{parentName:"p"},"@babel/")," packages or ",(0,i.kt)("inlineCode",{parentName:"p"},"eslint"),"."),(0,i.kt)("h2",{id:"pnpmneverbuiltdependencies"},"pnpm.neverBuiltDependencies"),(0,i.kt)("p",null,'This field allows to ignore the builds of specific dependencies. The "preinstall", "install", and "postinstall" scripts of the listed packages will not be executed during installation.'),(0,i.kt)("p",null,"An example of the ",(0,i.kt)("inlineCode",{parentName:"p"},'"pnpm"."neverBuiltDependencies"')," field:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "neverBuiltDependencies": ["fsevents", "level"]\n  }\n}\n')),(0,i.kt)("h2",{id:"pnpmonlybuiltdependencies"},"pnpm.onlyBuiltDependencies"),(0,i.kt)("p",null,"A list of package names that are allowed to be executed during installation. If this field exists, only the listed packages will be able to run install scripts."),(0,i.kt)("p",null,"\u793a\u4f8b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "onlyBuiltDependencies": ["fsevents"]\n  }\n}\n')),(0,i.kt)("h2",{id:"pnpmalloweddeprecatedversions"},"pnpm.allowedDeprecatedVersions"),(0,i.kt)("p",null,"This setting allows muting deprecation warnings of specific packages."),(0,i.kt)("p",null,"\u793a\u4f8b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "allowedDeprecatedVersions": {\n      "express": "1",\n      "request": "*"\n    }\n  }\n}\n')),(0,i.kt)("p",null,"With the above configuration pnpm will not print deprecation warnings about any version of ",(0,i.kt)("inlineCode",{parentName:"p"},"request")," and about v1 of ",(0,i.kt)("inlineCode",{parentName:"p"},"express"),"."),(0,i.kt)("h2",{id:"pnpmpatcheddependencies"},"pnpm.patchedDependencies"),(0,i.kt)("p",null,"This field is added/updated automatically when you run ",(0,i.kt)("a",{parentName:"p",href:"/zh/next/cli/patch-commit"},"pnpm patch-commit"),". It is a dictionary where the key should be the package name and exact version. The value should be a relative path to a patch file."),(0,i.kt)("p",null,"\u793a\u4f8b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "patchedDependencies": {\n      "express@4.18.1": "patches/express@4.18.1.patch"\n    }\n  }\n}\n')),(0,i.kt)("h2",{id:"pnpmallownonappliedpatches"},"pnpm.allowNonAppliedPatches"),(0,i.kt)("p",null,"When ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),", installation won't fail if some of the patches from the ",(0,i.kt)("inlineCode",{parentName:"p"},"patchedDependencies")," field were not applied."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "patchedDependencies": {\n      "express@4.18.1": "patches/express@4.18.1.patch"\n    }\n    "allowNonAppliedPatches": true\n}\n')),(0,i.kt)("h2",{id:"pnpmupdateconfig"},"pnpm.updateConfig"),(0,i.kt)("h3",{id:"pnpmupdateconfigignoredependencies"},"pnpm.updateConfig.ignoreDependencies"),(0,i.kt)("p",null,"Sometimes you can't update a dependency. For instance, the latest version of the dependency started to use ESM but your project is not yet in ESM. Annoyingly, such a package will be always printed out by the ",(0,i.kt)("inlineCode",{parentName:"p"},"pnpm outdated")," command and updated, when running ",(0,i.kt)("inlineCode",{parentName:"p"},"pnpm update --latest"),". However, you may list packages that you don't want to upgrade in the ",(0,i.kt)("inlineCode",{parentName:"p"},"ignoreDependencies")," field:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "updateConfig": {\n      "ignoreDependencies": ["load-json-file"]\n    }\n  }\n}\n')),(0,i.kt)("p",null,"Patterns are also supported, so you may ignore any packages from a scope: ",(0,i.kt)("inlineCode",{parentName:"p"},"@babel/*"),"."),(0,i.kt)("h2",{id:"pnpmauditconfig"},"pnpm.auditConfig"),(0,i.kt)("h3",{id:"pnpmauditconfigignorecves"},"pnpm.auditConfig.ignoreCves"),(0,i.kt)("p",null,"A list of CVE IDs that will be ignored by the ",(0,i.kt)("a",{parentName:"p",href:"/zh/next/cli/audit"},(0,i.kt)("inlineCode",{parentName:"a"},"pnpm audit"))," command."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pnpm": {\n    "auditConfig": {\n      "ignoreCves": [\n        "CVE-2022-36313"\n      ]\n    }\n  }\n}\n')),(0,i.kt)("h2",{id:"pnpmrequiredscripts"},"pnpm.requiredScripts"),(0,i.kt)("p",null,"\u5de5\u4f5c\u533a\u7684\u6bcf\u4e2a\u9879\u76ee\uff0c\u90fd\u5fc5\u987b\u542b\u6709\u6b64\u6570\u7ec4\u4e2d\u7684\u6240\u6709\u811a\u672c\u3002 Otherwise, ",(0,i.kt)("inlineCode",{parentName:"p"},"pnpm -r run <script name>")," will fail."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{\n  "pnpm": {\n    "requiredScripts": ["build"]\n  }\n}\n')),(0,i.kt)("h2",{id:"resolutions"},"resolutions"),(0,i.kt)("p",null,"Same as ",(0,i.kt)("a",{parentName:"p",href:"#pnpmoverrides"},(0,i.kt)("inlineCode",{parentName:"a"},"pnpm.overrides")),". We read it for easier migration from Yarn."))}k.isMDXComponent=!0}}]);